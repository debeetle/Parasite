(add-to-list 'custom-theme-load-path "/home/chaos/.config/emacs/themes")
(load-theme 'adwaita t)

;; For performance
;(load "server")
;(unless (server-running-p) (server-start))
(setq gc-cons-threshold 100000000)
(setq read-process-output-max (* 1024 1024)) ;; 1mb

(add-hook 'emacs-startup-hook #'(lambda ()
                               ;; restore after startup
                               (setq gc-cons-threshold 800000)))
(menu-bar-mode -1)
(tool-bar-mode -1)
(scroll-bar-mode -1)
(electric-pair-mode t) ;自动补全括号
(column-number-mode t) ;显示列号
(global-display-line-numbers-mode 1)
(require 'display-line-numbers)
(defun display-line-numbers--turn-on ()
  "Turn on `display-line-numbers-mode'."
  (unless (or (minibufferp) (eq major-mode 'pdf-view-mode))
    (display-line-numbers-mode)))
(display-time)
(setq make-backup-files -1) ;关闭文件自动备份
(setq inhibit-startup-screen t)           ; Disable startup screen
(setq ring-bell-function 'ignore)         ; Disable bell sound
(setq linum-format "%4d ")                ; Line number format
(setq-default frame-title-format '("%b")) ; Make window title the buffer name
(fset 'yes-or-no-p 'y-or-n-p)             ; y-or-n-p makes answering questions faster
(show-paren-mode t)                       ; Show closing parens by default
(delete-selection-mode t)                 ; Selected text will be overwritten when you start typing
(global-auto-revert-mode t)               ; Auto-update buffer if file has changed on disk
(add-hook 'before-save-hook
	  'delete-trailing-whitespace)    ; Delete trailing whitespace on save
;;; Lockfiles unfortunately cause more pain than benefit
(setq create-lockfiles -1)
;; (desktop-save-mode 1)
(setq locale-coding-system 'utf-8)
(set-terminal-coding-system 'utf-8)
(set-keyboard-coding-system 'utf-8)
(set-selection-coding-system 'utf-8)
(prefer-coding-system 'utf-8)

(require 'package )
(setq package-enable-at-startup -1)
(setq package-archives '(("gnu" . "https://mirrors.tuna.tsinghua.edu.cn/elpa/gnu/")
			 ("melpa" . "https://mirrors.tuna.tsinghua.edu.cn/elpa/melpa/")))
(unless package--initialized (package-initialize))

;;; Setup use-package
; (unless (package-installed-p 'use-package)
;   (package-refresh-contents)
;   (package-install 'use-package))
(eval-when-compile
	(require 'use-package))
(setq use-package-always-ensure t)
; (use-package rime
; 	:custom
; 	(default-input-method "rime"))

(custom-set-variables
 ;; custom-set-variables was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won't work right.
 '(package-selected-packages '(evil gnuplot indent-bars pdf-tools use-package)))
 ;; custom-set-variables was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won't work right.


;; (add-hook 'prog-mode-hook #'show-paren-mode) ;高亮另一个括号

(setq backup-inhibited t)
(add-hook 'prog-mode-hook #'hs-minor-mode) ;编程模式下，可以折叠代码块

(global-set-key (kbd "C-;") 'comment-line)
(setq font-lock-maximum-decoration t)
(setq scroll-margin 5
      scroll-conservatively 10000)
(transient-mark-mode t)
(setq kill-ring-max 30)
(setq default-frame-alist '((font . "Source Code Pro-10:weight=medium:slant=normal")))

(require 'evil)
(evil-mode 1)
;(provide 'init)
;;(add-to-list 'load-path "~/.config/emacs/site-lisp/emacs-application-framework/")
;;(require 'eaf)
;;(require 'eaf-browser)
;;(require 'eaf-pdf-viewer)
;;(let ((params (frame-parameters)))
(custom-set-faces
 ;; custom-set-faces was added by Custom.
 ;; If you edit it by hand, you could mess it up, so be careful.
 ;; Your init file should contain only one such instance.
 ;; If there is more than one, they won't work right.
 )
(use-package indent-bars
  :custom
  (indent-bars-no-descend-lists t) ; no extra bars in continued func arg lists
  (indent-bars-treesit-support t)
  (indent-bars-treesit-ignore-blank-lines-types '("module"))
  ;; Add other languages as needed
  (indent-bars-treesit-scope '((python function_definition class_definition for_statement
	  if_statement with_statement while_statement)))
  ;; Note: wrap may not be needed if no-descend-list is enough
  ;;(indent-bars-treesit-wrap '((python argument_list parameters ; for python, as an example
  ;;				      list list_comprehension
  ;;				      dictionary dictionary_comprehension
  ;;				      parenthesized_expression subscript)))
  :hook ((python-base-mode yaml-mode) . indent-bars-mode))


(setq initial-scratch-message "")         ; Make *scratch* buffer blank
(switch-to-buffer "*scratch*")
