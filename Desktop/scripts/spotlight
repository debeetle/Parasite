#!/usr/bin/dash
# set -eu -o pipefail

# app=$(pmenu -p 'open ' abiword audacity blender chromium emacs epiphany firefox foot freecad gimp inkscape matlab rosenrot steam pcmanfm qemu qutebrowser virtualbox zathura)
app=$(printf "abiword\naudacity\nblender\nchromium\nemacs\nfirefox\nfoot\nfreecad\ngimp\ninkscape\nmatlab\noctave\nrosenrot\nsteam-native\nqutebrowser\nvirtualbox\nzathura" | fzy -p 'open ' )

case "$app" in
    chromium)
        exec setsid dash -c "chromium --gtk-version=4 <&-"
        # exec setsid dash -c "chromium --gtk-version=4 > /dev/null 2>&1 &"
		;;
    emacs)
        exec setsid dash -c "emacsclient -a '' -c <&-"
        ;;
	# firefox)
	#        exec setsid dash -c "firefox <&-"
	#        ;;
    foot)
        exec setsid dash -c "footclient --log-level none <&-"
        ;;
	matlab)
		setsid dash -c "env LD_PRELOAD=/lib64/libstdc++.so LD_LIBRARY_PATH=/usr/lib/xorg/modules/dri/ LD_PRELOAD=/lib64/libfreetype.so _JAVA_AWT_WM_NONREPARENTING=1 QT_QPA_PLATFORM=xcb matlab -desktop -nosoftwareopengl & disown"
		;;
	octave)
		exec setsid dash -c "octave --gui <&-"
		;;
    *)
        # if which "$app" > /dev/null; then
		exec setsid dash -c "$app <&-"
        # else
            # firefox --new-tab --search "$app"
            # /usr/bin/qutebrowser --target auto "$app" > /dev/null 2>&1 &
        # fi
        ;;
esac
